<div class="fixed inset-0 bg-black z-[100] flex flex-col group/player">
    <div class="absolute top-0 left-0 w-full p-6 z-40 bg-gradient-to-b from-black/90 to-transparent flex justify-between items-center transition-opacity duration-300 player-ui">
        <a href="/series/<%= series.id %>" class="spa-link text-white hover:text-gray-300 flex items-center gap-3">
            <i class="fas fa-arrow-left text-2xl"></i>
            <div>
                <h2 class="font-bold text-sm leading-none"><%= series.title %></h2>
                <p class="text-xs text-gray-400">Ep <%= current.index %>: <%= current.name %></p>
            </div>
        </a>
    </div>

    <div id="video-wrapper" class="relative w-full h-full flex items-center justify-center bg-black">
        <video id="player-video" class="w-full h-full" playsinline
               data-id="<%= series.id %>" 
               data-ep="<%= current.id %>"
               <% if(next) { %> data-next="/watch/<%= series.id %>/<%= next.id %>" <% } %>>
            <source src="<%= streamUrl %>" type="video/mp4">
        </video>

        <div id="spinner" class="absolute inset-0 flex items-center justify-center bg-black/50 z-20">
            <div class="w-16 h-16 border-4 border-netflix-red border-t-transparent rounded-full animate-spin"></div>
        </div>

        <div id="center-icon" class="absolute inset-0 flex items-center justify-center z-30 pointer-events-none opacity-0 transform scale-50 transition-all">
            <i class="fas fa-play text-6xl text-white drop-shadow-lg"></i>
        </div>

        <div class="absolute bottom-0 left-0 w-full bg-gradient-to-t from-black/95 via-black/60 to-transparent px-6 pb-8 pt-20 z-40 transition-opacity duration-300 player-ui">
            <div class="relative h-1.5 bg-gray-600/50 rounded-full cursor-pointer group/timeline mb-4 hover:h-2.5 transition-all" id="timeline">
                <div id="buffer-bar" class="absolute top-0 left-0 h-full bg-white/30 rounded-full w-0 transition-all duration-300"></div>
                <div id="play-bar" class="absolute top-0 left-0 h-full bg-netflix-red rounded-full w-0 relative">
                    <div class="absolute right-0 top-1/2 -translate-y-1/2 w-4 h-4 bg-red-600 rounded-full scale-0 group-hover/timeline:scale-100 transition-transform shadow-lg border border-white"></div>
                </div>
            </div>

            <div class="flex items-center justify-between text-white">
                <div class="flex items-center gap-6">
                    <button id="btn-play" class="hover:text-netflix-red transition"><i class="fas fa-play text-3xl"></i></button>
                    <button id="btn-back" class="text-gray-300 hover:text-white"><i class="fas fa-rotate-left"></i> 10s</button>
                    <button id="btn-fwd" class="text-gray-300 hover:text-white"><i class="fas fa-rotate-right"></i> 10s</button>
                    <div class="text-xs font-mono text-gray-400">
                        <span id="time-cur">00:00</span> / <span id="time-dur">00:00</span>
                    </div>
                </div>
                
                <div class="flex items-center gap-5">
                    <% if(next) { %>
                    <a href="/watch/<%= series.id %>/<%= next.id %>" class="spa-link text-sm font-bold text-gray-300 hover:text-white flex items-center gap-1 bg-white/10 px-3 py-1 rounded">
                        NEXT EP <i class="fas fa-step-forward"></i>
                    </a>
                    <% } %>
                    <button id="btn-speed" class="font-bold text-sm w-8 hover:text-netflix-red">1x</button>
                    <button id="btn-fs" class="hover:text-netflix-red"><i class="fas fa-expand text-xl"></i></button>
                </div>
            </div>
        </div>

        <div id="auto-next" class="absolute bottom-24 right-8 bg-[#181818] border border-white/10 p-4 rounded-lg shadow-2xl z-50 w-80 transform translate-y-10 opacity-0 transition-all duration-500 hidden">
            <div class="flex justify-between items-start mb-2">
                <span class="text-[10px] font-bold uppercase tracking-widest text-gray-400">Up Next</span>
                <button id="btn-cancel-auto" class="text-gray-400 hover:text-white"><i class="fas fa-times"></i></button>
            </div>
            <div class="flex gap-3">
                <div class="w-24 h-14 bg-gray-800 rounded overflow-hidden">
                    <img src="<%= series.cover %>" class="w-full h-full object-cover opacity-70">
                </div>
                <div class="flex-1 min-w-0">
                    <h4 class="font-bold text-sm truncate text-white">Episode <%= current.index + 1 %></h4>
                    <div class="mt-2 w-full bg-gray-700 h-1 rounded-full overflow-hidden">
                        <div id="auto-timer-bar" class="h-full bg-netflix-red w-full"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>window.videoConfig = { id: "<%= series.id %>", ep: "<%= current.id %>" };</script>
